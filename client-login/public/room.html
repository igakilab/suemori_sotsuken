<!DOCTYPE html>
<!------この文書型宣言は忘れずに書く------>
<html>

<head>
  <title>ログイン</title>
  <meta http-equiv="content-language" content="ja">
  <meta charset="UTF-8">
  <script type="text/javascript" src="dwr/engine.js"></script>
  <script type="text/javascript" src="dwr/util.js"></script>
  <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
  <script type="text/javascript" src="js/jquery.serialize.js"></script>
  <script src="js/jquery.cookie.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-database.js"></script>
</head>

<body>
  <form name="room">
    2Pはルーム名を入力してください<br>
    <p>ルーム名<input type="text" name="roomname" value=""><br></p>
      <input type="button" value="ログイン" onclick="Log()"><br></p>
  </form>

  <form name="newaccount">
    1Pはルームを作るためこちらをクリックしてください<br>
    <input type="button" value="新規ルーム" onclick="location.href = 'roomcreate.html'"><br>
  </form>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDX5Eggo0Hjqq1snz-gTS8mlzbnOcCw1bc",
      authDomain: "bomber-3f3fd.firebaseapp.com",
      databaseURL: "https://bomber-3f3fd.firebaseio.com",
      projectId: "bomber-3f3fd",
      storageBucket: "bomber-3f3fd.appspot.com",
      messagingSenderId: "834527661420",
      appId: "1:834527661420:web:2b3b5a5059141eb6c6b749",
      measurementId: "G-KJK9C4Z8W0"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    const database = firebase.database();
    let room1 = "/room";
    
    function Log() {
      const str1 = document.room.roomname.value;
      database.ref(room1).on("child_added", function (data) {
        const v = data.val();
        if (v.str1 === str1) {
          OK();
          
        }
        
      });
    }



    function OK() {
      var roomname = document.room.roomname.value;
      document.cookie = 'roomname=' + roomname;
      document.cookie = 'player=2P';
      location.href = "http://192.168.1.18:8081/";

    }

  </script>
</body>

</html>
